# 异常控制流

## 异常与过程调用的区别

1. 过程调用是，在跳转到处理程序之前，处理器将返回地址压入栈中。然而，根据异常的类型，返回地址要么是当前指令，要么是下一条指令
2. 处理器也把一些额外的处理器状态压到栈里，在处理程序返回时，重新开始执行被中断的程序会需要这些状态
3. 如果控制从用户程序转移到内核，所有这些项目被压到内核栈中，而不是压到用户栈中。
4. 异常处理程序运行在内核模式下

## 异常的类别

1. 中断
2. 陷阱
3. 故障
4. 终止

中断是异步的，是来自处理器外部的I/O设备的信号的结果，在当前指令完成执行之后，处理器注意到中断引脚的电压变高了，就从系统总线读取异常号，然后调用适当的中断处理程序。

陷阱是有意的异常，是执行一条指令的结果。陷阱最重要的用途是在用户程序和内核之间提供一个像过程一样的接口，叫做系统调用。

故障由错误情况引起，当故障发生时，处理器将控制转移给故障处理程序，如果能够修正这个错误情况，它就将控制返回到引起故障的指令，从而执行它。否则执行内核中的abort例程，终止程序。

终止是不可恢复的致命错误造成的结果，通常是一些硬件错误。